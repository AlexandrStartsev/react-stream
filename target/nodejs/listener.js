module.exports =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded chunks
/******/ 	// "0" means "already loaded"
/******/ 	var installedChunks = {
/******/ 		"listener": 0
/******/ 	};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/ 	// This file contains only the entry chunk.
/******/ 	// The chunk loading function for additional chunks
/******/ 	__webpack_require__.e = function requireEnsure(chunkId) {
/******/ 		var promises = [];
/******/
/******/
/******/ 		// require() chunk loading for javascript
/******/
/******/ 		// "0" is the signal for "already loaded"
/******/ 		if(installedChunks[chunkId] !== 0) {
/******/ 			var chunk = require("./" + ({}[chunkId]||chunkId) + ".js");
/******/ 			var moreModules = chunk.modules, chunkIds = chunk.ids;
/******/ 			for(var moduleId in moreModules) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 			for(var i = 0; i < chunkIds.length; i++)
/******/ 				installedChunks[chunkIds[i]] = 0;
/******/ 		}
/******/ 		return Promise.all(promises);
/******/ 	};
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// uncaught error handler for webpack runtime
/******/ 	__webpack_require__.oe = function(err) {
/******/ 		process.nextTick(function() {
/******/ 			throw err; // catch this error by using import().catch()
/******/ 		});
/******/ 	};
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/ts/listener.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./resources/es-polyfill.js":
/*!**********************************!*\
  !*** ./resources/es-polyfill.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// Promise\r\ntypeof Promise === \"undefined\" && !function(t,e){ true?module.exports=e():undefined}(this,function(){\"use strict\";function t(t){var e=typeof t;return null!==t&&(\"object\"===e||\"function\"===e)}function e(t){return\"function\"==typeof t}function n(t){B=t}function r(t){G=t}function o(){return function(){return process.nextTick(a)}}function i(){return\"undefined\"!=typeof z?function(){z(a)}:c()}function s(){var t=0,e=new J(a),n=document.createTextNode(\"\");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<W;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}W=0}function f(){try{var t=Function(\"return this\")().require(\"vertx\");return z=t.runOnLoop||t.runOnContext,i()}catch(e){return c()}}function l(t,e){var n=this,r=new this.constructor(p);void 0===r[Z]&&O(r);var o=n._state;if(o){var i=arguments[o-1];G(function(){return P(o,r,i,n._result)})}else E(n,r,t,e);return r}function h(t){var e=this;if(t&&\"object\"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function v(){return new TypeError(\"You cannot resolve a promise with itself\")}function d(){return new TypeError(\"A promises callback cannot return that same promise.\")}function _(t){try{return t.then}catch(e){return nt.error=e,nt}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){G(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},\"Settle: \"+(t._label||\" unknown promise\"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===tt?S(t,e._result):e._state===et?j(t,e._result):E(e,void 0,function(e){return g(t,e)},function(e){return j(t,e)})}function w(t,n,r){n.constructor===t.constructor&&r===l&&n.constructor.resolve===h?b(t,n):r===nt?(j(t,nt.error),nt.error=null):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function g(e,n){e===n?j(e,v()):t(n)?w(e,n,_(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function S(t,e){t._state===$&&(t._result=e,t._state=tt,0!==t._subscribers.length&&G(T,t))}function j(t,e){t._state===$&&(t._state=et,t._result=e,G(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+tt]=n,o[i+et]=r,0===i&&t._state&&G(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function M(t,e){try{return t(e)}catch(n){return nt.error=n,nt}}function P(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=M(r,o),s===nt?(a=!0,u=s.error,s.error=null):c=!0,n===s)return void j(n,d())}else s=o,c=!0;n._state!==$||(i&&c?g(n,s):a?j(n,u):t===tt?S(n,s):t===et&&j(n,s))}function x(t,e){try{e(function(e){g(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function C(){return rt++}function O(t){t[Z]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(){return new Error(\"Array Methods must be provided an Array\")}function F(t){return new ot(this,t).promise}function Y(t){var e=this;return new e(U(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError(\"You must pass an array to race.\"))})}function q(t){var e=this,n=new e(p);return j(n,t),n}function D(){throw new TypeError(\"You must pass a resolver function as the first argument to the promise constructor\")}function K(){throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\")}function L(){var t=void 0;if(\"undefined\"!=typeof global)t=global;else if(\"undefined\"!=typeof self)t=self;else try{t=Function(\"return this\")()}catch(e){throw new Error(\"polyfill failed because global object is unavailable in this environment\")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if(\"[object Promise]\"===r&&!n.cast)return}t.Promise=it}var N=void 0;N=Array.isArray?Array.isArray:function(t){return\"[object Array]\"===Object.prototype.toString.call(t)};var U=N,W=0,z=void 0,B=void 0,G=function(t,e){V[W]=t,V[W+1]=e,W+=2,2===W&&(B?B(a):X())},H=\"undefined\"!=typeof window?window:void 0,I=H||{},J=I.MutationObserver||I.WebKitMutationObserver,Q=\"undefined\"==typeof self&&\"undefined\"!=typeof process&&\"[object process]\"==={}.toString.call(process),R=\"undefined\"!=typeof Uint8ClampedArray&&\"undefined\"!=typeof importScripts&&\"undefined\"!=typeof MessageChannel,V=new Array(1e3),X=void 0;X=Q?o():J?s():R?u():void 0===H&&\"function\"==\"function\"?f():c();var Z=Math.random().toString(36).substring(2),$=void 0,tt=1,et=2,nt={error:null},rt=0,ot=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[Z]||O(this.promise),U(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&S(this.promise,this._result))):j(this.promise,k())}return t.prototype._enumerate=function(t){for(var e=0;this._state===$&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=_(t);if(o===l&&t._state!==$)this._settledAt(t._state,e,t._result);else if(\"function\"!=typeof o)this._remaining--,this._result[e]=t;else if(n===it){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===$&&(this._remaining--,t===et?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(tt,e,t)},function(t){return n._settledAt(et,e,t)})},t}(),it=function(){function t(e){this[Z]=C(),this._result=this._state=void 0,this._subscribers=[],p!==e&&(\"function\"!=typeof e&&D(),this instanceof t?x(this,e):K())}return t.prototype[\"catch\"]=function(t){return this.then(null,t)},t.prototype[\"finally\"]=function(t){var e=this,n=e.constructor;return e.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})})},t}();return it.prototype.then=l,it.all=F,it.race=Y,it.resolve=h,it.reject=q,it._setScheduler=n,it._setAsap=r,it._asap=G,it.polyfill=L,it.Promise=it,it.polyfill(),it});\r\n\r\n// WeakMap\r\n(function(e){\"use strict\";if(e.WeakMap){return}var t=Object.prototype.hasOwnProperty;var r=function(e,t,r){if(Object.defineProperty){Object.defineProperty(e,t,{configurable:true,writable:true,value:r})}else{e[t]=r}};e.WeakMap=function(){function WeakMap(){if(this===void 0){throw new TypeError(\"Constructor WeakMap requires 'new'\")}r(this,\"_id\",genId(\"_WeakMap\"));if(arguments.length>0){throw new TypeError(\"WeakMap iterable is not supported\")}}r(WeakMap.prototype,\"delete\",function(e){checkInstance(this,\"delete\");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){delete e[this._id];return true}return false});r(WeakMap.prototype,\"get\",function(e){checkInstance(this,\"get\");if(!isObject(e)){return void 0}var t=e[this._id];if(t&&t[0]===e){return t[1]}return void 0});r(WeakMap.prototype,\"has\",function(e){checkInstance(this,\"has\");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){return true}return false});r(WeakMap.prototype,\"set\",function(e,t){checkInstance(this,\"set\");if(!isObject(e)){throw new TypeError(\"Invalid value used as weak map key\")}var n=e[this._id];if(n&&n[0]===e){n[1]=t;return this}r(e,this._id,[e,t]);return this});function checkInstance(e,r){if(!isObject(e)||!t.call(e,\"_id\")){throw new TypeError(r+\" method called on incompatible receiver \"+typeof e)}}function genId(e){return e+\"_\"+rand()+\".\"+rand()}function rand(){return Math.random().toString().substring(2)}r(WeakMap,\"_polyfill\",true);return WeakMap}();function isObject(e){return Object(e)===e}})(typeof self!==\"undefined\"?self:typeof window!==\"undefined\"?window:typeof global!==\"undefined\"?global:this);\r\n\r\n(function(g){\r\nvar Symbol = g.Symbol||(g.Symbol = {});\r\nSymbol.iterator || (Symbol.iterator='Symbol(Symbol.iterator)')\r\nSymbol.toStringTag || (Symbol.toStringTag='Symbol(Symbol.toStringTag)')\r\n\r\nArray.isArray || (Array.isArray = function(o) { return o instanceof Array })\r\nArray.prototype.forEach || (Array.prototype.forEach = function(f, a) { for(var i = 0; i < this.length; i++) f.call(a, this[i], i, this) })\r\nArray.prototype.indexOf || (Array.prototype.indexOf = function(e) { var i=this.length-1; for(;i>=0 && this[i] != e;i--); return i; })\r\nArray.prototype.filter || (Array.prototype.filter = function(f, a) { var r=[],i; for(i=0; i < this.length; i++) f.call(a, this[i], i, this) && r.push(this[i]); return r } )\r\nArray.prototype.map || (Array.prototype.map = function(f, a) { var r=[],i; for(i=0; i < this.length; i++) r.push(f.call(a, this[i], i, this)); return r } )\r\nArray.from || (Array.from = function(s) { \r\n    var r = [], o;\r\n    Symbol && Symbol.iterator && (typeof s[Symbol.iterator] === 'function') && (s=s[Symbol.iterator]());\r\n    if(typeof s.next === 'function') \r\n        while(!(o=s.next()).done) \r\n            r.push(o.value); \r\n    else \r\n        s.forEach(function(e) { r.push(e); } ); \r\n    return r; \r\n})\r\nif (typeof Object.assign != 'function') {\r\n    Object.assign = function(target) {\r\n        'use strict';\r\n        if (target == null) {\r\n            throw new TypeError('Cannot convert undefined or null to object');\r\n        }\r\n        target = Object(target);\r\n        for (var index = 1; index < arguments.length; index++) {\r\n            var source = arguments[index];\r\n            if (source != null) {\r\n                for (var key in source) {\r\n                    if (Object.prototype.hasOwnProperty.call(source, key)) {\r\n                        target[key] = source[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return target;\r\n    };\r\n}\r\n\r\n    g.Map || (g.Map = function(i) { this.size = 0; i && Array.from(i).forEach(function(a) { a=Array.from(a); this.set(a[0], a[1]) }, this) },\r\n    Map.prototype.clear = function() { delete this.head; this.size = 0; },\r\n    Map.prototype[Symbol.iterator] = function() {\r\n        return {\r\n            pos: this.head,\r\n            next: function () {\r\n                return this.pos ? (r = { value: [this.pos.key, this.pos.value], done: false }, (this.pos=this.pos.next), r) : { done : true };\r\n            }\r\n        }\r\n    },\r\n    Map.prototype.keys = function() {\r\n        return {\r\n            pos: this.head,\r\n            next: function () {\r\n                return this.pos ? (r = { value: this.pos.key, done: false }, (this.pos=this.pos.next), r) : { done : true };\r\n            }\r\n        }\r\n    },\r\n    Map.prototype.values = function() {\r\n        return {\r\n            pos: this.head,\r\n            next: function () {\r\n                return this.pos ? (r = { value: this.pos.value, done: false }, (this.pos=this.pos.next), r) : { done : true };\r\n            }\r\n        }\r\n    },        \r\n    Map.prototype.entries = Map.prototype[Symbol.iterator],\r\n    Map.prototype.set = function(k,v) {\r\n        if(!this.head) {\r\n            this.head = {key: k, value: v};\r\n            this.size++;\r\n        } else {\r\n            if(this.head.key == k) {\r\n                this.head.value = v;\r\n            } else {\r\n                var h = this.head;\r\n                for(; h.next && h.next.key != k; h=h.next) ;\r\n                if(!h.next) {\r\n                    h.next = {key: k};\r\n                    this.size++;\r\n                }\r\n                h.next.value = v;\r\n            }\r\n        }\r\n        return this; \r\n    },\r\n    Map.prototype['delete'] = function(k) {\r\n        if(this.head) {\r\n            if(this.head.key == k) {\r\n                this.head = this.head.next;\r\n                this.size--;\r\n                return true;\r\n            } else {\r\n                var h = this.head;\r\n                for(; h.next && h.next.key != k ; h=h.next);\r\n                if(h.next) {\r\n                    h.next = h.next.next;\r\n                    this.size --;\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    Map.prototype.get = function(k) {\r\n        var h = this.head;\r\n        for(; h; h=h.next) \r\n            if(h && h.key == k) return h.value;\r\n    },\r\n    Map.prototype.has = function(k) { return typeof this.get(k) !== 'undefined'; },\r\n    Map.prototype.forEach = function(f, a) {\r\n        var h = this.head;\r\n        for(; h; h=h.next) \r\n            f.call(a, h.value, h.key, this);\r\n    },\r\n    Map.prototype.keys = function() { var ret = []; for(var h = this.head; h; h=h.next)  ret.push(h.key);  return ret;},\r\n    Map.prototype.values = function() { var ret = []; for(var h = this.head; h; h=h.next)  ret.push(h.value);  return ret;},\r\n    Map)\r\n    \r\n    g.Set || (g.Set = function(i) { this.size = 0; i && Array.from(i).forEach(function(v) { this.add(v) }, this) },\r\n    Set.prototype[Symbol.iterator] = function() {\r\n        return {\r\n            pos: this.head,\r\n            next: function () {\r\n                return this.pos ? (r = { value: this.pos.key, done: false }, (this.pos=this.pos.next), r) : { done : true };\r\n            }\r\n        }\r\n    },\r\n    Set.prototype.keys = Set.prototype[Symbol.iterator],\r\n    Set.prototype.entries = Set.prototype[Symbol.iterator],\r\n    Set.prototype.add = function(k) {\r\n        if(!this.head) {\r\n            this.head = {key: k};\r\n            this.size++;\r\n        } else {\r\n            if(this.head.key != k) {\r\n                var h = this.head;\r\n                for(; h.next && h.next.key != k; h=h.next) ;\r\n                if(!h.next) {\r\n                    h.next = {key: k};\r\n                    this.size++;\r\n                }\r\n            }\r\n        }\r\n        return this; \r\n    },\r\n    Set.prototype.clear = function() { delete this.head; this.size = 0; },\r\n    Set.prototype['delete'] = function(k) {\r\n        if(this.head) {\r\n            if(this.head.key == k) {\r\n                this.head = this.head.next;\r\n                this.size--;\r\n                return true;\r\n            } else {\r\n                var h = this.head;\r\n                for(; h.next && h.next.key != k ; h=h.next);\r\n                if(h.next) {\r\n                    h.next = h.next.next;\r\n                    this.size --;\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    Set.prototype.forEach = function (f, a) {\r\n        for(var h = this.head; h; h=h.next) \r\n            f.call(a, h.key, this);\r\n    },\r\n    Set.prototype.has = function(k) { \r\n        for(var h = this.head; h; h=h.next) \r\n            if(h && h.key == k) return true;\r\n        return false;\r\n    },\r\n    Set)\r\n\r\n})(\"undefined\"!==typeof window?window:global)\n\n//# sourceURL=webpack://listener/./resources/es-polyfill.js?");

/***/ }),

/***/ "./src/ts/api/ajaxCache.ts":
/*!*********************************!*\
  !*** ./src/ts/api/ajaxCache.ts ***!
  \*********************************/
/*! exports provided: Cache, ImmediatePromise, ajaxCache, AjaxStatus, ajaxRequired, ajaxFeed */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Cache\", function() { return Cache; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ImmediatePromise\", function() { return ImmediatePromise; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ajaxCache\", function() { return ajaxCache; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AjaxStatus\", function() { return AjaxStatus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ajaxRequired\", function() { return ajaxRequired; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ajaxFeed\", function() { return ajaxFeed; });\n/* harmony import */ var _dfe_stream__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dfe-stream */ \"./src/ts/api/dfe-stream.ts\");\nvar __assign = (undefined && undefined.__assign) || Object.assign || function(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n            t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\n\r\nvar CacheImpl = /** @class */ (function () {\r\n    function CacheImpl(options) {\r\n        this.storage = new Map();\r\n        this.cleanupTimer = 0;\r\n        this.options = Object.assign({ lifespan: 0, maxSize: 0 }, __assign({}, options || {}));\r\n    }\r\n    CacheImpl.prototype.get = function (key, compute) {\r\n        if (this.storage.has(key)) {\r\n            var data = this.storage.get(key), now = +new Date();\r\n            if (this.options.lifespan <= 0 || data.timeStamp + this.options.lifespan > now) {\r\n                data.timeStamp = now;\r\n                return data.value;\r\n            }\r\n        }\r\n        var value = compute(key);\r\n        this.set(key, value);\r\n        return value;\r\n    };\r\n    CacheImpl.prototype.set = function (key, value) {\r\n        var _this = this;\r\n        var data = { timeStamp: +new Date(), value: value };\r\n        this.storage.set(key, data);\r\n        this.cleanupTimer || this.options.lifespan > 0 && (this.cleanupTimer = setInterval(function () { return _this.cleanup(); }, 1000));\r\n        var size = this.storage.size || this.storage.length;\r\n        if (this.options.maxSize > 0 && size > this.options.maxSize) {\r\n            var first_1, set_1 = false;\r\n            this.storage.forEach(function (_, key) { return set_1 || (set_1 = true, first_1 = key); });\r\n            this.storage.delete(first_1);\r\n        }\r\n    };\r\n    CacheImpl.prototype.expireAfter = function (key, millis) {\r\n        if (this.options.lifespan > 0 && this.storage.has(key)) {\r\n            var data = this.storage.get(key), now = +new Date();\r\n            data.timeStamp = now - this.options.lifespan + millis;\r\n        }\r\n    };\r\n    CacheImpl.prototype.has = function (key) {\r\n        var data = this.storage.get(key);\r\n        return !!data && (this.options.lifespan <= 0 || data.timeStamp + this.options.lifespan > +new Date());\r\n    };\r\n    CacheImpl.prototype.clear = function () {\r\n        this.storage.clear();\r\n        this.cleanupTimer && clearInterval(this.cleanupTimer);\r\n        this.cleanupTimer = 0;\r\n    };\r\n    CacheImpl.prototype.cleanup = function () {\r\n        var _this = this;\r\n        var cutOff = +new Date() - this.options.lifespan;\r\n        this.storage.forEach(function (value, key) { return value.timeStamp <= cutOff && _this.storage.delete(key); });\r\n        if (this.storage.size === 0) {\r\n            clearInterval(this.cleanupTimer);\r\n            this.cleanupTimer = 0;\r\n        }\r\n    };\r\n    CacheImpl.prototype.getAccessedSince = function (cutOff) {\r\n        var ret = {};\r\n        this.storage.forEach(function (value, key) { return value.timeStamp >= cutOff && (ret[key] = value.value); });\r\n        return ret;\r\n    };\r\n    return CacheImpl;\r\n}());\r\nvar JavaCacheBuilder = typeof Java !== 'undefined' ? Java.type('com.google.common.cache.CacheBuilder') : null;\r\nvar JavaTimeUnit = typeof Java !== 'undefined' ? Java.type('java.util.concurrent.TimeUnit') : null;\r\nvar GuavaCache = /** @class */ (function () {\r\n    function GuavaCache(options) {\r\n        var builder = JavaCacheBuilder.newBuilder();\r\n        options && (options.lifespan && builder.expireAfterAccess(options.lifespan, JavaTimeUnit.MILLISECONDS),\r\n            options.maxSize && builder.maximumSize(options.maxSize));\r\n        this.impl = builder.build();\r\n    }\r\n    GuavaCache.prototype.get = function (key, compute) {\r\n        var val = this.impl.get(key, function (key) { return ({ value: compute(key) }); });\r\n        val.timeStamp = +new Date();\r\n        return val.value;\r\n    };\r\n    GuavaCache.prototype.set = function (key, value) {\r\n        this.impl.put(key, { value: value, timeStamp: +new Date() });\r\n    };\r\n    GuavaCache.prototype.has = function (key) {\r\n        return this.impl.getIfPresent(key) !== null;\r\n    };\r\n    GuavaCache.prototype.clear = function () {\r\n        return this.impl.invalidateAll();\r\n    };\r\n    GuavaCache.prototype.expireAfter = function (key, millis) {\r\n        var _this = this;\r\n        setTimeout(function () { return _this.impl.invalidate(key); }, millis);\r\n    };\r\n    GuavaCache.prototype.getAccessedSince = function (cutOff) {\r\n        var ret = {};\r\n        this.impl.asMap().forEach(function (key, value) { return value.timeStamp >= cutOff && (ret[key] = value.value); });\r\n        return ret;\r\n    };\r\n    return GuavaCache;\r\n}());\r\nvar newCache = JavaCacheBuilder ? function (options) { return new GuavaCache(options); } : function (options) { return new CacheImpl(options); };\r\nvar Cache = /** @class */ (function () {\r\n    function Cache(options) {\r\n        this.impl = newCache(options);\r\n    }\r\n    Cache.prototype.get = function (key, compute) {\r\n        return this.impl.get(key, compute);\r\n    };\r\n    Cache.prototype.set = function (key, value) {\r\n        this.impl.set(key, value);\r\n    };\r\n    Cache.prototype.has = function (key) {\r\n        return this.impl.has(key);\r\n    };\r\n    Cache.prototype.clear = function () {\r\n        return this.impl.clear();\r\n    };\r\n    Cache.prototype.getAccessedSince = function (cutOff) {\r\n        return this.impl.getAccessedSince(cutOff);\r\n    };\r\n    Cache.prototype.expireAfter = function (key, millis) {\r\n        this.impl.expireAfter(key, millis);\r\n    };\r\n    return Cache;\r\n}());\r\n\r\nvar ImmediatePromise = /** @class */ (function () {\r\n    function ImmediatePromise() {\r\n    }\r\n    return ImmediatePromise;\r\n}());\r\n\r\nvar ajaxCache = {\r\n    storage: new Cache({ lifespan: 60000, maxSize: 1000 }),\r\n    get: function (opt) {\r\n        var base =  true ? \"https://arrowheadexchange.com/AJAXServlet.srv?\" : undefined;\r\n        if (typeof opt !== 'string' && !opt.url) { // method: ... action: ...\r\n            var u_1 = base;\r\n            for (var o in opt) {\r\n                var a = opt[o];\r\n                (Array.isArray(a) ? a : [a]).forEach(function (v) { return u_1 += encodeURIComponent(o) + '=' + encodeURIComponent(typeof v == 'object' ? JSON.stringify(v) : v) + '&'; });\r\n            }\r\n            opt = u_1.replace(/\\&$/, '');\r\n        }\r\n        var url = typeof opt === 'string' ? opt : opt.url, key = encodeURIComponent(url.replace(base, ''));\r\n        var storage = this.storage;\r\n        return storage.get(key, function () {\r\n            var ret = {};\r\n            ret.promise = new Promise(function (resolve, reject) {\r\n                var xhr = new XMLHttpRequest();\r\n                try {\r\n                    var dataType_1 = opt.dataType || 'json', so = typeof opt.data === 'object';\r\n                    var hrds = __assign({ 'Content-Type': so ? 'application/json' : 'application/x-www-form-urlencoded' }, opt.headers);\r\n                    xhr.open(opt.type || 'GET', so ? url : url + '&cacheKey=' + key);\r\n                    for (var i in hrds)\r\n                        xhr.setRequestHeader(i, hrds[i]);\r\n                    dataType_1 == 'json' && xhr.setRequestHeader('Accept', 'application/json');\r\n                    xhr.onreadystatechange = function () {\r\n                        if (this.readyState === 4) {\r\n                            ret.done = \"success\";\r\n                            if (this.status == 200)\r\n                                try {\r\n                                    var r = this.response || this.responseText;\r\n                                    resolve(ret.result = typeof r == 'string' && dataType_1 == 'json' ? JSON.parse(r) : r);\r\n                                }\r\n                                catch (e) {\r\n                                    ret.done = \"rejected\";\r\n                                    reject(ret.result = e);\r\n                                    storage.expireAfter(key, 1000);\r\n                                }\r\n                            else {\r\n                                ret.done = \"rejected\";\r\n                                reject(ret.result = xhr);\r\n                                storage.expireAfter(key, 1000);\r\n                            }\r\n                        }\r\n                    };\r\n                    xhr.send(so ? __assign({ cacheKey: key }, opt.data) : opt.data);\r\n                }\r\n                catch (e) {\r\n                    ret.done = \"rejected\";\r\n                    reject(ret.result = e);\r\n                    storage.expireAfter(key, 1000);\r\n                }\r\n            });\r\n            return ret;\r\n        });\r\n    }\r\n};\r\nvar AjaxStatus;\r\n(function (AjaxStatus) {\r\n    AjaxStatus[\"error\"] = \"error\";\r\n    AjaxStatus[\"loading\"] = \"loading\";\r\n    AjaxStatus[\"done\"] = \"done\";\r\n})(AjaxStatus || (AjaxStatus = {}));\r\nfunction ajaxRequired(value, model, context) {\r\n    var status = value.status, errorMessage = value.errorMessage;\r\n    if (status === 'done') {\r\n        if (value.items.length === 0) {\r\n            return 'Not found';\r\n        }\r\n        return Object(_dfe_stream__WEBPACK_IMPORTED_MODULE_0__[\"required\"])(value);\r\n    }\r\n    return status === 'loading' ? context.lastError() : errorMessage || 'Ajax error';\r\n}\r\nfunction ajaxFeed(context, value, args) {\r\n    var onSuccess = function (data, ctx) {\r\n        try {\r\n            var items = Array.isArray(data && data.result) ? data.result : [];\r\n            ctx.result({\r\n                value: value,\r\n                items: args.mapper ? items.map(args.mapper) : items,\r\n                status: AjaxStatus.done\r\n            });\r\n        }\r\n        catch (e) {\r\n            ctx.result({ value: value, items: [], status: AjaxStatus.error, errorMessage: e.message });\r\n        }\r\n    };\r\n    var onReject = function (xhr, ctx) {\r\n        ctx.result({\r\n            value: value,\r\n            items: [],\r\n            status: AjaxStatus.error,\r\n            errorMessage: xhr instanceof XMLHttpRequest ? xhr.responseText.substr(0, 500) + \"...\" : xhr.message\r\n        });\r\n    };\r\n    var p = ajaxCache.get(args.query);\r\n    if (!p.done) {\r\n        context.await(p.promise, onSuccess, onReject);\r\n        context.result({ value: value, items: [{ value: undefined, description: \"Loading...\" }], status: AjaxStatus.loading });\r\n    }\r\n    else {\r\n        (p.done === \"success\" ? onSuccess : onReject)(p.result, context);\r\n    }\r\n    return undefined;\r\n}\r\n\n\n//# sourceURL=webpack://listener/./src/ts/api/ajaxCache.ts?");

/***/ }),

/***/ "./src/ts/api/dfe-stream.ts":
/*!**********************************!*\
  !*** ./src/ts/api/dfe-stream.ts ***!
  \**********************************/
/*! exports provided: ValidationStrategy, ContextModel, Field, LogicNode, testChoice, arfDatePattern, required, LogicProcessor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ValidationStrategy\", function() { return ValidationStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ContextModel\", function() { return ContextModel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Field\", function() { return Field; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LogicNode\", function() { return LogicNode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"testChoice\", function() { return testChoice; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"arfDatePattern\", function() { return arfDatePattern; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"required\", function() { return required; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LogicProcessor\", function() { return LogicProcessor; });\n/* harmony import */ var _proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./proxy */ \"./src/ts/api/proxy.ts\");\n\r\nvar ValidationStrategy;\r\n(function (ValidationStrategy) {\r\n    ValidationStrategy[ValidationStrategy[\"None\"] = 0] = \"None\";\r\n    ValidationStrategy[ValidationStrategy[\"Always\"] = 1] = \"Always\";\r\n    ValidationStrategy[ValidationStrategy[\"Followup\"] = 2] = \"Followup\";\r\n    ValidationStrategy[ValidationStrategy[\"Notified\"] = 3] = \"Notified\";\r\n    ValidationStrategy[ValidationStrategy[\"Validate\"] = 4] = \"Validate\";\r\n})(ValidationStrategy || (ValidationStrategy = {}));\r\nfunction doValidation(events, vstrategy) {\r\n    vstrategy = vstrategy === undefined ? ValidationStrategy.Validate : vstrategy;\r\n    if (vstrategy === undefined || vstrategy === ValidationStrategy.Validate) {\r\n        return events.some(function (e) { return 'validate' === e.action; });\r\n    }\r\n    return vstrategy === ValidationStrategy.Always || vstrategy === ValidationStrategy.Notified && events[0].action != 'init';\r\n}\r\nfunction errorwatch(node, target, reducer) {\r\n    var error = '';\r\n    var myModel = node.model;\r\n    var erroringChildren = new _proxy__WEBPACK_IMPORTED_MODULE_0__[\"ModelProxy\"](target === 'peers' ? node.parent : target, null, null, true, node.runtime.evListener).forWatcher(node).get('erroringChildren');\r\n    if (target === 'peers') {\r\n        erroringChildren.forEach(function (node) { return myModel.hasChild(node.model) && (error = reducer ? reducer(error, node.lastError) : node.lastError); });\r\n    }\r\n    else {\r\n        erroringChildren.forEach(function (node) { return error = reducer(error, node.lastError); });\r\n    }\r\n    return error;\r\n}\r\nvar ContextModel = /** @class */ (function () {\r\n    function ContextModel(model, unbound, runtime, node) {\r\n        this.$runtime = runtime;\r\n        this.$node = node;\r\n        this.$model = model;\r\n        this.$unbound = unbound;\r\n        this.$await = null;\r\n    }\r\n    ContextModel.prototype.result = function (data, error) {\r\n        var node = this.$node;\r\n        if (data !== undefined) {\r\n            if (error === undefined) {\r\n                var lastNotifications = node.lastNotifications, field = node.field, lastError = node.lastError;\r\n                if (field.errorwatch) {\r\n                    var _a = typeof field.errorwatch === 'object' ? field.errorwatch : {}, _b = _a.target, target = _b === void 0 ? node : _b, _c = _a.accept, accept = _c === void 0 ? function (a, b) { return b; } : _c;\r\n                    error = errorwatch(node, target, accept);\r\n                }\r\n                else {\r\n                    var validationResult = '';\r\n                    try {\r\n                        validationResult = (lastError || doValidation(lastNotifications, field.vstrategy)) && field.val && field.val(data, node.model, this, lastNotifications) || '';\r\n                    }\r\n                    catch (e) {\r\n                        validationResult = e.message || 'exception';\r\n                    }\r\n                    error = typeof validationResult === 'string' ? validationResult : '';\r\n                }\r\n            }\r\n            node.accept(data, error);\r\n        }\r\n        else {\r\n            if (error !== undefined) {\r\n                node.accept(node.lastData, error);\r\n            }\r\n        }\r\n    };\r\n    ContextModel.prototype.reject = function () {\r\n        this.$node.notify({ action: 'notify' });\r\n    };\r\n    ContextModel.prototype.destroy = function () {\r\n        this.$await = null;\r\n        this.$model.$listener.undepend();\r\n    };\r\n    ContextModel.prototype.await = function (promise, onSuccess, onReject) {\r\n        var _this = this;\r\n        this.$await = promise.then(function (a) { return (_this.$await = null, onSuccess && onSuccess(a, _this)); }, function (b) { return (_this.$await = null, onReject && onReject(b, _this)); });\r\n    };\r\n    ContextModel.prototype.lastError = function () {\r\n        return this.$node.lastError;\r\n    };\r\n    return ContextModel;\r\n}());\r\n\r\nvar Field = /** @class */ (function () {\r\n    function Field(props) {\r\n        this.children = [];\r\n        this.children = [];\r\n        this.get = function (model) { return model; };\r\n        Object.assign(this, props);\r\n    }\r\n    Field.prototype.with = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        this.children = args.reduce(function (out, cur) { return out.concat(cur); }, []).filter(function (o) { return o instanceof Field; });\r\n        return this;\r\n    };\r\n    return Field;\r\n}());\r\n\r\nvar LogicNode = /** @class */ (function () {\r\n    function LogicNode(parent, field, proxy, runtime) {\r\n        this.notifications = [];\r\n        this.children = new Map();\r\n        this.erroringChildren = new Set();\r\n        var unbound = proxy.forWatcher();\r\n        this.parent = parent;\r\n        this.runtime = runtime;\r\n        this.key = \"field:\" + unbound.key; //field.name + '-' + unbound.key;\r\n        this.field = field;\r\n        this.model = unbound.forWatcher(this);\r\n        this.context = new ContextModel(this.model, unbound, runtime, this);\r\n    }\r\n    LogicNode.prototype.notify = function (action) {\r\n        var _a;\r\n        if (!this.terminated) {\r\n            Array.isArray(action) ? (_a = this.notifications).splice.apply(_a, [this.notifications.length, 0].concat(action)) : this.notifications.push(action || { action: 'self' });\r\n            this.runtime.scheduleWork(this);\r\n        }\r\n        return this;\r\n    };\r\n    LogicNode.prototype.accept = function (data, error) {\r\n        if (!this.terminated) {\r\n            var childrenFields = this.field.children;\r\n            if (data !== undefined) {\r\n                // todo: evaliate lastData vs data and maybe skip rendering/child reconciliation \r\n                if (!this.field.errorwatch) {\r\n                    error ? this.runtime.notifyErroring(this) : this.runtime.clearError(this);\r\n                }\r\n                if (childrenFields.length) {\r\n                    var arr = data && typeof data === 'object' ? (Array.isArray(data) ? data : [data]) : [];\r\n                    // ??\r\n                    //arr.map(d => d instanceof JsonProxy ? d : new JsonProxy(d));\r\n                    this.runtime.reconcileChildren(this, arr, this.lastNotifications);\r\n                }\r\n                this.lastData = data;\r\n                this.lastError = error;\r\n                this.consumer && this.consumer.accept(data, error);\r\n                //this.shouldRender = true;\r\n                this.runtime.scheduleWork(this);\r\n            }\r\n            else {\r\n                error && (this.lastError = error) && this.runtime.notifyErroring(this);\r\n            }\r\n        }\r\n    };\r\n    LogicNode.prototype.terminate = function () {\r\n        //this.control.destroy();\r\n        if (!this.terminated) {\r\n            this.context.destroy();\r\n            if (this.parent) {\r\n                var fieldMap = this.parent.children.get(this.model.key);\r\n                if (fieldMap) {\r\n                    fieldMap.delete(this.field);\r\n                    fieldMap.size || this.parent.children.delete(this.model.key);\r\n                }\r\n                this.parent = null;\r\n            }\r\n            this.terminated = true;\r\n            this.consumer && this.consumer.terminate();\r\n            this.consumer = null;\r\n        }\r\n    };\r\n    return LogicNode;\r\n}());\r\n\r\n//###############################################################################################################################\r\nfunction testChoice(a, b) {\r\n    return a == b || typeof a === 'object' && typeof b === 'object' && Object.keys(a).every(function (i) { return a[i] == b[i]; });\r\n}\r\nvar arfDatePattern = /^(18|19|20)((\\\\d\\\\d(((0[1-9]|1[012])(0[1-9]|1[0-9]|2[0-8]))|((0[13578]|1[02])(29|30|31))|((0[4,6,9]|11)(29|30))))|(([02468][048]|[13579][26])0229))$/;\r\nfunction required(value, pattern, message) {\r\n    if (!value || value.toString().replace(/ /g, '') === '') {\r\n        return message || 'Required';\r\n    }\r\n    else {\r\n        if (typeof value === 'object' && Array.isArray(value.items)) {\r\n            var v_1 = value.value;\r\n            if (!v_1 || v_1.toString().replace(/ /g, '') === '') {\r\n                return message || 'Required';\r\n            }\r\n            return value.items.some(function (item) { return testChoice(v_1, item.value !== undefined ? item.value : item); }) ? '' : message || 'Required';\r\n        }\r\n        if (pattern === 'date' && !value.toString().match(arfDatePattern) || pattern instanceof RegExp && !value.toString().match(pattern)) {\r\n            return message || 'Invalid format';\r\n        }\r\n        return '';\r\n    }\r\n}\r\n//###############################################################################################################################\r\nvar LogicProcessor = /** @class */ (function () {\r\n    function LogicProcessor(rootProxy, rootField, validate) {\r\n        // TODO: this is technically leaking memory (watchers are not removed when runtime shuts down when this is static).\r\n        // I've made it non-static, so it gets disposed of every time runtime is shut down. But it s better to figure out why and fix.\r\n        this.evListener = new _proxy__WEBPACK_IMPORTED_MODULE_0__[\"Listener\"]({});\r\n        this.nodes = [];\r\n        this.scheduledWork = null;\r\n        this.addNode(null, rootProxy, rootField, [{ action: validate ? \"validate\" : \"init\" }]);\r\n        this.rootModel = this.nodes[0].model;\r\n        this.processInterceptors();\r\n    }\r\n    LogicProcessor.prototype.scheduleWork = function (node) {\r\n        this.scheduledWork || (this.scheduledWork = (typeof setImmediate === \"function\" ? setImmediate : setTimeout)(this.processInterceptors.bind(this)));\r\n    };\r\n    LogicProcessor.prototype.destroy = function () {\r\n        this.scheduledWork && (typeof clearImmediate === \"function\" ? clearImmediate : clearInterval)(this.scheduledWork);\r\n        this.scheduledWork = null;\r\n        if (this.nodes.length) {\r\n            var root = this.nodes[0];\r\n            this.evictNode(root);\r\n            this.nodes = [];\r\n        }\r\n    };\r\n    LogicProcessor.prototype.enforceValidation = function (readyCb) {\r\n        this.nodes.forEach(function (node) { return node.notify({ action: 'validate' }); });\r\n        readyCb && this.waitForPipeLine(readyCb);\r\n    };\r\n    LogicProcessor.prototype.waitForPipeLine = function (readyCb) {\r\n        var pending = [];\r\n        try {\r\n            this.processInterceptors();\r\n            this.scheduledWork || (pending = this.nodes.map(function (n) { return n.context.$await; }).filter(function (a) { return !!a; })).length ?\r\n                Promise.all(pending).then(this.waitForPipeLine.bind(this, readyCb), readyCb) : readyCb();\r\n        }\r\n        catch (e) {\r\n            readyCb(e);\r\n        }\r\n    };\r\n    LogicProcessor.prototype.processInterceptors = function () {\r\n        var _this = this;\r\n        if (this.scheduledWork) {\r\n            this.scheduledWork = null;\r\n            for (var i = 0; i < this.nodes.length; i++) {\r\n                this.logic(this.nodes[i]);\r\n            }\r\n            var cur_1 = 0;\r\n            this.nodes.forEach(function (node) { return node.terminated || (_this.nodes[cur_1++] = node); });\r\n            this.nodes.splice(cur_1);\r\n        }\r\n    };\r\n    LogicProcessor.prototype.addNode = function (parent, proxy, field, initAction) {\r\n        var node = new LogicNode(parent, field, proxy, this);\r\n        node.notify(initAction);\r\n        this.nodes.push(node);\r\n        return node;\r\n    };\r\n    LogicProcessor.prototype.evictNode = function (node) {\r\n        var _this = this;\r\n        this.clearError(node);\r\n        node.terminated = true;\r\n        node.children.forEach(function (fieldMap) { return fieldMap.forEach(function (node) { return _this.evictNode(node); }); });\r\n        node.terminate();\r\n    };\r\n    LogicProcessor.prototype.clearError = function (node) {\r\n        if (node.lastError) {\r\n            delete node.lastError;\r\n            for (var cur = node.parent; cur && cur.erroringChildren.delete(node); cur = cur.parent) {\r\n                this.evListener.notify(cur.key, 'erroringChildren');\r\n            }\r\n        }\r\n    };\r\n    LogicProcessor.prototype.notifyErroring = function (node) {\r\n        for (var cur = node.parent; cur && !cur.erroringChildren.has(node); cur = cur.parent) {\r\n            cur.erroringChildren.add(node), this.evListener.notify(cur.key, 'erroringChildren', 'validate');\r\n        }\r\n    };\r\n    LogicProcessor.prototype.reconcileChildren = function (parent, rowProxies, events) {\r\n        var _this = this;\r\n        var childFields = parent.field.children;\r\n        var lastChildren = parent.children;\r\n        if (lastChildren.size || childFields.length) {\r\n            var rows_1 = new Map();\r\n            var rkeys_1 = new Set();\r\n            var m_1, present_1;\r\n            lastChildren.forEach(function (_, k) { return rkeys_1.add(k); });\r\n            rowProxies.forEach(function (r) { rows_1.set(r.key, r); rkeys_1.add(r.key); });\r\n            rkeys_1.forEach(function (r) {\r\n                present_1 = rows_1.get(r);\r\n                if (m_1 = lastChildren.get(r)) {\r\n                    present_1 || (childFields.forEach(function (k) { return _this.evictNode(m_1.get(k)); }), lastChildren.delete(r));\r\n                }\r\n                else {\r\n                    lastChildren.set(r, m_1 = new Map());\r\n                    childFields.forEach(function (k) { return m_1.set(k, _this.addNode(parent, present_1, k, events)); });\r\n                }\r\n            });\r\n        }\r\n    };\r\n    LogicProcessor.prototype.logic = function (node) {\r\n        if (node.notifications.length && !node.terminated) {\r\n            node.lastNotifications = node.notifications;\r\n            node.notifications = [];\r\n            var context = node.context, field = node.field, model = node.model;\r\n            try {\r\n                context.result(field.get(model, context, node.lastNotifications));\r\n            }\r\n            catch (e) {\r\n                context.result(undefined, e.message);\r\n                console.error(node.field + '\\n' + e.message + '\\n' + e.stack);\r\n            }\r\n        }\r\n    };\r\n    LogicProcessor.prototype.findNodes = function (field, modelKey) {\r\n        return this.nodes.filter(function (node) { return node.field === field && node.model.key === modelKey; });\r\n    };\r\n    return LogicProcessor;\r\n}()); //const { Provider: LogicContextProvider, Consumer: LogicContextConsumer} = React.createContext({} as LogicProcessor);\r\n\r\n\n\n//# sourceURL=webpack://listener/./src/ts/api/dfe-stream.ts?");

/***/ }),

/***/ "./src/ts/api/proxy.ts":
/*!*****************************!*\
  !*** ./src/ts/api/proxy.ts ***!
  \*****************************/
/*! exports provided: Enumerable, Observable, Listener, JsonProxyKeygey, JsonProxyArray, ModelProxy, ProxyUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Enumerable\", function() { return Enumerable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Observable\", function() { return Observable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Listener\", function() { return Listener; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JsonProxyKeygey\", function() { return JsonProxyKeygey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JsonProxyArray\", function() { return JsonProxyArray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ModelProxy\", function() { return ModelProxy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ProxyUtils\", function() { return ProxyUtils; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n/**\r\n * @Enumerable decorator that sets the enumerable property of a class field to false.\r\n * @param value true|false\r\n */\r\nfunction Enumerable(value) {\r\n    return function (target, propertyKey) {\r\n        var descriptor = Object.getOwnPropertyDescriptor(target, propertyKey) || {};\r\n        if (descriptor.enumerable != value) {\r\n            descriptor.enumerable = value;\r\n            Object.defineProperty(target, propertyKey, descriptor);\r\n        }\r\n    };\r\n}\r\nfunction Observable(proxyClass) {\r\n    return function (target, propertyKey) {\r\n        var _a;\r\n        if (proxyClass) {\r\n            var isSubset = typeof proxyClass === \"function\";\r\n            isSubset || (proxyClass = proxyClass[0]);\r\n            Object.defineProperties(target, (_a = {},\r\n                _a[propertyKey] = {\r\n                    enumerable: true,\r\n                    get: isSubset ? function () {\r\n                        return this.getSubset(propertyKey, proxyClass);\r\n                    } : function () {\r\n                        return this.getSublist(propertyKey, proxyClass);\r\n                    }\r\n                },\r\n                _a[\"$_c_\" + propertyKey] = {\r\n                    enumerable: true,\r\n                    value: function (value) {\r\n                        ProxyUtils.copy(this[propertyKey], value);\r\n                    }\r\n                },\r\n                _a[\"$_r_\" + propertyKey] = {\r\n                    enumerable: true,\r\n                    value: function (value) {\r\n                        ProxyUtils.reflect(this[propertyKey], value);\r\n                    }\r\n                },\r\n                _a));\r\n        }\r\n        else {\r\n            Object.defineProperty(target, propertyKey, {\r\n                enumerable: true,\r\n                get: function () {\r\n                    return this.get(propertyKey) || \"\";\r\n                },\r\n                set: function (value) {\r\n                    this.set(propertyKey, value);\r\n                }\r\n            });\r\n        }\r\n    };\r\n}\r\nvar Listener = /** @class */ (function () {\r\n    function Listener(model, node) {\r\n        this.dpMap = model instanceof Listener ? model.dpMap : Listener.getRootDependencyMap(model);\r\n        this.node = node;\r\n        this.dependencies = [];\r\n    }\r\n    Listener.getRootDependencyMap = function (model) {\r\n        if (model) {\r\n            var p = void 0;\r\n            if (model instanceof ModelProxy) {\r\n                for (p = model; p.$parent; p = p.$parent)\r\n                    ;\r\n                p = p.$data; // $persisted ?\r\n            }\r\n            else {\r\n                for (p = model; p.p; p = p.p)\r\n                    ;\r\n            }\r\n            var m = Listener.modelWatchMap.get(p);\r\n            m || Listener.modelWatchMap.set(p, m = new Map());\r\n            return m;\r\n        }\r\n        return new Map();\r\n    };\r\n    Listener.prototype.undepend = function () {\r\n        var _this = this;\r\n        this.dependencies.forEach(function (dpKey) {\r\n            var ctlSet = _this.dpMap.get(dpKey);\r\n            if (ctlSet) {\r\n                ctlSet.delete(_this.node);\r\n                ctlSet.size || _this.dpMap.delete(dpKey);\r\n            }\r\n        });\r\n    };\r\n    Listener.prototype.depend = function (key, element) {\r\n        if (this.node) {\r\n            var dpKey = key + '-' + element, e = this.dpMap.get(dpKey);\r\n            e || this.dpMap.set(dpKey, e = new Set());\r\n            if (!e.has(this.node)) {\r\n                e.add(this.node);\r\n                this.dependencies.push(dpKey);\r\n            }\r\n        }\r\n    };\r\n    Listener.prototype.notify = function (key, element, action, value) {\r\n        var dpKey = key + '-' + element, e = this.dpMap.get(dpKey);\r\n        e && e.forEach(function (node) { return node.notify({ key: key, element: element, action: action }); });\r\n        return true;\r\n    };\r\n    Listener.prototype.set = function (proxy, element, value, action) {\r\n        if (proxy.$data[element] != value) {\r\n            proxy.$data[element] = value;\r\n            this.notify(proxy.key, element, action);\r\n        }\r\n        ;\r\n        return true;\r\n    };\r\n    Listener.prototype.get = function (proxy, element) {\r\n        this.depend(proxy.key, element);\r\n        return proxy.$data[element];\r\n    };\r\n    // TODO: this is still an issue. loop over Core.startRuntime multiple times causes memory leaks when passing same data object. Workaround is to pass different data object (shallow copy is fine). \r\n    Listener.modelWatchMap = new WeakMap();\r\n    return Listener;\r\n}());\r\n\r\nvar JsonProxyKeygey = (function () {\r\n    var counter = 0;\r\n    return function () {\r\n        return ++counter;\r\n    };\r\n})();\r\nvar JsonProxyArray = /** @class */ (function (_super) {\r\n    __extends(JsonProxyArray, _super);\r\n    function JsonProxyArray(parent, parentCollection, clazz) {\r\n        var _this = this;\r\n        if (typeof parent === 'number') {\r\n            _this = _super.call(this, parent) || this;\r\n        }\r\n        else {\r\n            _this = _super.call(this) || this;\r\n            Array.prototype.push.apply(_this, (parent.get(parentCollection) || []).map(function (item) { return new clazz(item, parent, parentCollection, false, parent.$listener); }));\r\n        }\r\n        _this.$parent = parent;\r\n        _this.$parentCollection = parentCollection;\r\n        _this.$clazz = clazz;\r\n        Object.setPrototypeOf(_this, JsonProxyArray.prototype);\r\n        return _this;\r\n    }\r\n    JsonProxyArray.prototype.push = function () {\r\n        var _this = this;\r\n        var items = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            items[_i] = arguments[_i];\r\n        }\r\n        return Array.prototype.push.apply(this, items.map(function (item) {\r\n            var proxy = (new _this.$clazz({}, _this.$parent, _this.$parentCollection, false, _this.$parent.$listener));\r\n            ProxyUtils.copy(proxy, item);\r\n            _this.$parent.append(_this.$parentCollection, false, proxy.$data);\r\n            return proxy;\r\n        }));\r\n    };\r\n    JsonProxyArray.prototype.shadow = function (item) {\r\n        var proxy = (new this.$clazz({}, this.$parent, this.$parentCollection, false, this.$parent.$listener));\r\n        typeof item === 'object' && ProxyUtils.copy(proxy, item);\r\n        proxy.$persisted = null;\r\n        return proxy;\r\n    };\r\n    JsonProxyArray.prototype.pop = function () { throw \"Unsupported\"; };\r\n    JsonProxyArray.prototype.splice = function (start, deleteCount) {\r\n        var items = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            items[_i - 2] = arguments[_i];\r\n        }\r\n        throw \"Unsupported\";\r\n    };\r\n    JsonProxyArray.prototype.shift = function () { throw \"Unsupported\"; };\r\n    JsonProxyArray.prototype.unshift = function () {\r\n        var items = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            items[_i] = arguments[_i];\r\n        }\r\n        throw \"Unsupported\";\r\n    };\r\n    JsonProxyArray.prototype.reverse = function () { throw \"Unsupported\"; };\r\n    /*sort(cb?: (a: P, b: P) => number): this { throw \"Unsupported\"; }*/\r\n    JsonProxyArray.prototype.fill = function () { throw \"Unsupported\"; };\r\n    JsonProxyArray.prototype.copyWithin = function () { throw \"Unsupported\"; };\r\n    JsonProxyArray.prototype.indexOf = function (item) {\r\n        return item instanceof ModelProxy ? [].indexOf.call(this.map(function (a) { return a.$data; }), item.$data) : -1;\r\n    };\r\n    return JsonProxyArray;\r\n}(Array));\r\n\r\nvar ModelProxy = /** @class */ (function () {\r\n    function ModelProxy(data, parent, parentCollection, single, listener) {\r\n        this.$persisted = data;\r\n        this.$data = (data || {});\r\n        this.$parent = parent || null;\r\n        this.$listener = listener || new Listener(this);\r\n        this.$single = single === undefined ? true : single;\r\n        this.$parentCollection = parentCollection || '';\r\n    }\r\n    Object.defineProperty(ModelProxy.prototype, \"key\", {\r\n        get: function () {\r\n            var data = this.$data, key = data.key;\r\n            key || Object.defineProperty(data, 'key', { enumerable: false, value: key = JsonProxyKeygey() });\r\n            return key;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ModelProxy.prototype, \"p\", {\r\n        get: function () {\r\n            return this.$parent.forWatcher(this.$listener.node);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ModelProxy.prototype.forWatcher = function (watcher) {\r\n        var ctor = this.constructor;\r\n        var ret = new ctor(this.$data, this.$parent, this.$parentCollection, this.$single, new Listener(this.$listener, watcher));\r\n        ret.$persisted = this.$persisted;\r\n        return ret;\r\n    };\r\n    ModelProxy.prototype.get = function (element) {\r\n        this.$listener.depend(this.key, element);\r\n        return this.$data[element];\r\n    };\r\n    ModelProxy.prototype.getSubset = function (element, proxyClass) {\r\n        if (element) {\r\n            return new proxyClass(this.get(element), this, element, true, this.$listener);\r\n        }\r\n        return new proxyClass(this.$data, this, null, true, this.$listener);\r\n    };\r\n    ModelProxy.prototype.getSublist = function (element, proxyClass) {\r\n        return new JsonProxyArray(this, element, proxyClass);\r\n    };\r\n    ModelProxy.prototype.append = function (element, single, data) {\r\n        this.persist();\r\n        if (element) {\r\n            if (single) {\r\n                var obj = this.$data[element];\r\n                if (!obj || typeof obj !== 'object') {\r\n                    obj = this.$data[element] = data || {};\r\n                    this.$listener.notify(this.key, element, 'a');\r\n                }\r\n                else {\r\n                    // TODO: merge ? \r\n                }\r\n                return obj;\r\n            }\r\n            else {\r\n                var arr = this.$data[element], obj = data || {};\r\n                if (!Array.isArray(arr)) {\r\n                    this.$data[element] = arr = [];\r\n                }\r\n                arr.push(obj);\r\n                this.$listener.notify(this.key, element, 'a');\r\n                return obj;\r\n            }\r\n        }\r\n        return this.$data;\r\n    };\r\n    ModelProxy.prototype.set = function (element, value) {\r\n        if (value === undefined || value === null || value === '') {\r\n            if (this.$data.hasOwnProperty(element)) {\r\n                delete this.$data[element];\r\n                this.$listener.notify(this.key, element, 'd');\r\n            }\r\n        }\r\n        else {\r\n            this.persist();\r\n            if (this.$data[element] !== value) {\r\n                this.$data[element] = value;\r\n                this.$listener.notify(this.key, element, 'm');\r\n            }\r\n        }\r\n        return value;\r\n    };\r\n    ModelProxy.prototype.persist = function () {\r\n        if (this.isShadow() && this.$parent) {\r\n            // TODO: merge ? \r\n            this.$persisted = this.$data = this.$parent.append(this.$parentCollection, this.$single, this.$data);\r\n        }\r\n    };\r\n    ModelProxy.prototype.detach = function () {\r\n        if (this.$parent) {\r\n            if (this.$persisted) {\r\n                if (this.$parentCollection) {\r\n                    var collection = this.$parent.$data[this.$parentCollection];\r\n                    if (collection) {\r\n                        collection.splice(collection.indexOf(this.$persisted), 1);\r\n                        collection.length || delete this.$parent.$data[this.$parentCollection];\r\n                        this.$listener.notify(this.$parent.key, this.$parentCollection, 'r');\r\n                    }\r\n                }\r\n                else {\r\n                    this.$parent.detach();\r\n                }\r\n                this.$persisted = undefined;\r\n            }\r\n        }\r\n        else {\r\n            throw 'attempt to detach root';\r\n        }\r\n    };\r\n    ModelProxy.prototype.isShadow = function () {\r\n        return !this.$persisted;\r\n    };\r\n    ModelProxy.prototype.hasChild = function (other) {\r\n        for (; other && this.$data !== other.$data; other = other.$parent) { }\r\n        return !!other;\r\n    };\r\n    __decorate([\r\n        Enumerable(false)\r\n    ], ModelProxy.prototype, \"key\", null);\r\n    __decorate([\r\n        Enumerable(false)\r\n    ], ModelProxy.prototype, \"p\", null);\r\n    return ModelProxy;\r\n}());\r\n\r\nvar ProxyUtils;\r\n(function (ProxyUtils) {\r\n    function castAs(data, impl) {\r\n        return typeof impl === \"function\" ? (new impl(data, null, null, true)) : data;\r\n    }\r\n    ProxyUtils.castAs = castAs;\r\n    function detach(v) {\r\n        if (v instanceof ModelProxy) {\r\n            v.detach();\r\n        }\r\n        else {\r\n            throw \"Not an instance of supported class\";\r\n        }\r\n    }\r\n    ProxyUtils.detach = detach;\r\n    function copy(dest, src) {\r\n        return merge(dest, src, false);\r\n    }\r\n    ProxyUtils.copy = copy;\r\n    function reflect(dest, src) {\r\n        return merge(dest, src, true);\r\n    }\r\n    ProxyUtils.reflect = reflect;\r\n    function unwrap(src) {\r\n        return src instanceof ModelProxy ? src.$data : src;\r\n    }\r\n    ProxyUtils.unwrap = unwrap;\r\n    function wrapAs(data, proto) {\r\n        if (proto instanceof ModelProxy) {\r\n            return castAs(data, proto.constructor);\r\n        }\r\n        if (proto instanceof JsonProxyArray) {\r\n            return castAs(data, proto.$clazz);\r\n        }\r\n        throw \"Not an instance of supported class\";\r\n    }\r\n    ProxyUtils.wrapAs = wrapAs;\r\n    function shadow(array, item) {\r\n        return array.shadow(item);\r\n    }\r\n    ProxyUtils.shadow = shadow;\r\n    function isDetached(target) {\r\n        return target instanceof ModelProxy && target.isShadow();\r\n    }\r\n    ProxyUtils.isDetached = isDetached;\r\n    function persist(target) {\r\n        target instanceof ModelProxy && target.persist();\r\n    }\r\n    ProxyUtils.persist = persist;\r\n    function merge(dest, src, deleteMissing) {\r\n        if (dest instanceof ModelProxy) {\r\n            mergeSubstet(dest, src, deleteMissing);\r\n        }\r\n        else if (dest instanceof JsonProxyArray) {\r\n            mergeArrays(dest, src, deleteMissing);\r\n        }\r\n        else {\r\n            throw \"Not an instance of supported class\";\r\n        }\r\n        return dest;\r\n    }\r\n    function mergeSubstet(dest, other, deleteMissing) {\r\n        // TODO: it would be nice to memorize list of cloneable properties for every class\r\n        // perhaps make map (ctor, ctor) => {list of properties to copy}, like Java proxies do in \"reflect/copy\"\r\n        var myFields = new Set(), otherFields = new Set(), writeEmpty = !(other instanceof ModelProxy);\r\n        Object.keys(dest.constructor.prototype).forEach(function (prop) { return prop.charAt(0) !== '$' && prop !== 'constructor' && myFields.add(prop); });\r\n        if (typeof other === 'object' && other !== null) {\r\n            Object.keys(other instanceof ModelProxy ? dest.constructor.prototype : other).forEach(function (prop) { return otherFields.add(prop); });\r\n        }\r\n        var prefix = deleteMissing ? '$_r_' : '$_c_', func;\r\n        myFields.forEach(function (prop) {\r\n            if (typeof (func = dest[prefix + prop]) === 'function') {\r\n                otherFields.has(prop) ? func.call(dest, other[prop]) : deleteMissing && func.call(dest);\r\n            }\r\n            else {\r\n                var v = otherFields.has(prop) ? other[prop] : undefined;\r\n                if (v !== null && v !== undefined && (v !== \"\" || writeEmpty) && v !== false || deleteMissing) {\r\n                    dest[prop] = v;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    function mergeArrays(dest, src, deleteMissing) {\r\n        src = src || [];\r\n        if (deleteMissing) {\r\n            for (var i = 0; i < dest.length && i < dest.length; i++) {\r\n                if (i === src.length) {\r\n                    dest.splice(i);\r\n                }\r\n                else if (i === dest.length) {\r\n                    dest.push(src[i]);\r\n                }\r\n                else {\r\n                    merge(dest[i], src[i], true);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            src.forEach(function (i) { return dest.push(i); });\r\n        }\r\n    }\r\n})(ProxyUtils || (ProxyUtils = {}));\r\n\n\n//# sourceURL=webpack://listener/./src/ts/api/proxy.ts?");

/***/ }),

/***/ "./src/ts/forms lazy recursive ^\\.\\/.*$":
/*!*****************************************************!*\
  !*** ./src/ts/forms lazy ^\.\/.*$ namespace object ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var map = {\n\t\"./quote.cmau.car\": [\n\t\t\"./src/ts/forms/quote.cmau.car.tsx\",\n\t\t9,\n\t\t6,\n\t\t7,\n\t\t2\n\t],\n\t\"./quote.cmau.car.css\": [\n\t\t\"./src/ts/forms/quote.cmau.car.css\",\n\t\t7,\n\t\t1\n\t],\n\t\"./quote.cmau.car.tsx\": [\n\t\t\"./src/ts/forms/quote.cmau.car.tsx\",\n\t\t9,\n\t\t6,\n\t\t7,\n\t\t2\n\t],\n\t\"./quote.work.class\": [\n\t\t\"./src/ts/forms/quote.work.class.tsx\",\n\t\t9,\n\t\t6,\n\t\t7,\n\t\t4\n\t],\n\t\"./quote.work.class.css\": [\n\t\t\"./src/ts/forms/quote.work.class.css\",\n\t\t7,\n\t\t3\n\t],\n\t\"./quote.work.class.tsx\": [\n\t\t\"./src/ts/forms/quote.work.class.tsx\",\n\t\t9,\n\t\t6,\n\t\t7,\n\t\t4\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn Promise.all(ids.slice(2).map(__webpack_require__.e)).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__.t(id, ids[1])\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = \"./src/ts/forms lazy recursive ^\\\\.\\\\/.*$\";\nmodule.exports = webpackAsyncContext;\n\n//# sourceURL=webpack://listener/./src/ts/forms_lazy_^\\.\\/.*$_namespace_object?");

/***/ }),

/***/ "./src/ts/listener.ts":
/*!****************************!*\
  !*** ./src/ts/listener.ts ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _resources_es_polyfill__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../resources/es-polyfill */ \"./resources/es-polyfill.js\");\n/* harmony import */ var _resources_es_polyfill__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_resources_es_polyfill__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _api_proxy__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./api/proxy */ \"./src/ts/api/proxy.ts\");\n/* harmony import */ var _api_ajaxCache__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./api/ajaxCache */ \"./src/ts/api/ajaxCache.ts\");\n/* harmony import */ var _api_dfe_stream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./api/dfe-stream */ \"./src/ts/api/dfe-stream.ts\");\n/**\r\n * Alex: this module can be used with nodejs and nashorn (after nashorn-utils.js is loaded).\r\n *\r\n */\r\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\ntypeof XMLHttpRequest === \"undefined\" && Object.assign(global, __webpack_require__(/*! xmlhttprequest */ \"xmlhttprequest\"));\r\nvar Service = /** @class */ (function () {\r\n    function Service() {\r\n    }\r\n    /*service(task: Task): void {\r\n        try {\r\n            switch(task.type) {\r\n            case \"VALIDATION_TASK\":\r\n                var payload = JSON.parse(task.payload);\r\n                this.validate(payload.formName, payload.policyData, function(e) {\r\n                    task.future.complete(JSON.stringify({result: e.length === 0, errors: e}));\r\n                });\r\n                break ;\r\n            case \"SSR_TASK\":\r\n                var payload = JSON.parse(task.payload);\r\n                this.ssr(payload.formName, payload.policyData, function(html, cachePrimer) {\r\n                    task.future.complete(JSON.stringify({html: html, cachePrimer: cachePrimer}));\r\n                });\r\n                break ;\r\n            case \"VIEW_TASK\":\r\n                var payload = JSON.parse(task.payload);\r\n                this.view(payload.formName, task.session).then(s => task.future.complete(s), e => task.future.completeExceptionally(WrapAsJavaException(e)))\r\n                break ;\r\n            default:\r\n                throw \"unknown task type\";\r\n            }\r\n        } catch(e) {\r\n            task.future.completeExceptionally(WrapAsJavaException(e));\r\n        }\r\n    }\r\n    async view(viewName: string, session: Session) {\r\n        session.jsonParser = JSON.parse\r\n        let React = await import('react');\r\n        let view = await import(\"./views/\" + viewName);\r\n        return renderToString(React.createElement(view.default, {session: session}));\r\n    }*/\r\n    Service.prototype.validate = function (formName, data, callback) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var setup, logic;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, __webpack_require__(\"./src/ts/forms lazy recursive ^\\\\.\\\\/.*$\")(\"./\" + formName)];\r\n                    case 1:\r\n                        setup = _a.sent();\r\n                        logic = new _api_dfe_stream__WEBPACK_IMPORTED_MODULE_3__[\"LogicProcessor\"](_api_proxy__WEBPACK_IMPORTED_MODULE_1__[\"ProxyUtils\"].castAs(Object.assign({}, data), setup.modelImpl), setup.form, true);\r\n                        logic.waitForPipeLine(function (reject) { return callback(reject ? [\"Exception during validation\" + reject.message] : logic.nodes.map(function (n) { return n.lastError; }).filter(function (reject) { return !!reject; })); });\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Service.prototype.ssr = function (formName, data, callback) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var cacheTimeStamp, React, renderToString, setup, logic;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        cacheTimeStamp = +new Date();\r\n                        return [4 /*yield*/, __webpack_require__.e(/*! import() */ 6).then(__webpack_require__.t.bind(null, /*! react */ \"./node_modules/react/index.js\", 7))];\r\n                    case 1:\r\n                        React = _a.sent();\r\n                        return [4 /*yield*/, Promise.all(/*! import() */[__webpack_require__.e(6), __webpack_require__.e(0)]).then(__webpack_require__.bind(null, /*! ../../resources/react-dom-server */ \"./resources/react-dom-server.js\"))];\r\n                    case 2:\r\n                        renderToString = (_a.sent()).renderToString;\r\n                        return [4 /*yield*/, __webpack_require__(\"./src/ts/forms lazy recursive ^\\\\.\\\\/.*$\")(\"./\" + formName)];\r\n                    case 3:\r\n                        setup = _a.sent();\r\n                        logic = new _api_dfe_stream__WEBPACK_IMPORTED_MODULE_3__[\"LogicProcessor\"](_api_proxy__WEBPACK_IMPORTED_MODULE_1__[\"ProxyUtils\"].castAs(Object.assign({}, data), setup.modelImpl), setup.form, true);\r\n                        logic.waitForPipeLine(function (reject) {\r\n                            if (reject) {\r\n                                console.warn(\"Exception during form side rendering: \" + formName, reject);\r\n                                callback(\"<label>Exception during form side rendering</label>\", []);\r\n                            }\r\n                            else {\r\n                                var cache_1 = _api_ajaxCache__WEBPACK_IMPORTED_MODULE_2__[\"ajaxCache\"].storage.getAccessedSince(cacheTimeStamp);\r\n                                var html = renderToString(React.createElement(setup.FormComponent, { model: logic.rootModel }));\r\n                                callback(html, Object.keys(cache_1).filter(function (key) { return cache_1[key].done === \"success\"; }).map(function (key) { return ({ key: key, value: cache_1[key].result }); }));\r\n                            }\r\n                        });\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return Service;\r\n}());\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (new Service());\r\n\n\n//# sourceURL=webpack://listener/./src/ts/listener.ts?");

/***/ }),

/***/ "xmlhttprequest":
/*!*********************************!*\
  !*** external "xmlhttprequest" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"xmlhttprequest\");\n\n//# sourceURL=webpack://listener/external_%22xmlhttprequest%22?");

/***/ })

/******/ });